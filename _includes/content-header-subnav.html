{% assign page_url = page.url | remove: 'index.html' %}
{% assign url_parts = page_url | split: '/' %}
{% assign rm = url_parts | last | append: '/index.html' %}
{% assign base_url = page.url | replace: rm %}

<header class="content-header">
  <section class="title">
    {% for node in site.pages %}
      {% if node.url == parent_url %}
        <p class="section-title"><span>{{ node.title }}</span></p>
        <h1>{{ page.title }}</h1>
      {% endif %}
    {% endfor %}
  </section>
</header>

<p>{{page.url}}</p>
<section class="subnav">
  <ul>
    {% for node in site.pages %}
      {% if node.url contains base_url %}
        {% assign node_url = node.url | remove: 'index.html' %}
        {% if node_url == page_url %}
          <li><a class="active" href="{{node_url}}">{{node.title}}</a></li>
        {% elsif node_url != base_url %}
          <li><a href="{{node_url}}">{{node.title}}</a></li>
        {% endif %}
      {% endif %}
    {% endfor %}
  </ul>
</section>
